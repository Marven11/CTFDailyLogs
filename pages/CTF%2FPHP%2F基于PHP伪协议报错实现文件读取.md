tags:: [[CTF/伪协议]]

- # 字符编码格式
	- `UNICODE`: 用2字节表示一个字符，小端序，前面再加上2字节`%FF%FE`
	- `UCS-4`：简单地使用4字节表示一个字符
	- `UCS-4LE`：简单地使用4字节表示一个字符，小端序，<127的字符的有效位被排在前面
	- `CP930`: 对比ascii会将小写字母向后rotate一位，也就是让a->b, b->c, ...
- # PHP伪协议filter
	- `convert.iconv.UTF8.UCS-4`: 将文件大小变为原来的四倍
	- `dechunk`:
		- 在文件的第一个字符是hex字符时读取错误，导致读取结果为空
		- 否则原样输出文本...?
- # 套路
	- 读取第一个字节
		- 将需要读取的字节移动到第一个字节，然后通过dechunk检测其是否处于[a-f]区间中
		- 检测将其rotate多少次可以移出/移动进区间，据此猜测其是什么小写字符
		- 其他字符可以通过编码转换得到
	- 移动其他字节到第一个字节处
		- 在内容的最前方加上2字节，使用`UCS-4->UCS-4LE`翻转每4字节
		- 然后删除加上的2字节，再翻转一次
		- 这样就可以将某个字节向前移动4位
- # 参考
	- https://xz.aliyun.com/t/12939